#!/usr/bin/env python3

import os
import sys


# Define VTmodule class
class VTmodule:
    __mmio_regs = []

    # define initializing function which initializes __mmio_regs with 0 elements
    def __init__(self):
        self.__mmio_regs = []

    # define a private method that generates a file called "object name"_mmio.vs, this file should contain the mmio registers
    def __generate_mmio(self, object_name):
        # define a variable mmio_file which is the file to be generated
        mmio_file = open(object_name + "_mmio.vs", "w")
        # write the header of the file
        mmio_file.write("/*\n")
        mmio_file.write(" * This file is generated by VTmodule.py\n")
        mmio_file.write(" * It contains the mmio registers of " + object_name + "\n")
        mmio_file.write(" */\n\n")
        # write the mmio registers
        for mmio_reg in self.__mmio_regs:
            mmio_file.write(mmio_reg + "\n")
        # close the file
        mmio_file.close()

    # define a public method that adds a mmio register to the list of mmio registers
    def add_mmio(self, mmio_reg):
        self.__mmio_regs.append(mmio_reg)

    # define a public method that calls all private generate methods
    def generate(self, object_name):
        self.__generate_mmio(object_name)

    # define a mmio_reg sub class that when initialized receives its name, size, address, a reset value, a description, a boolean that indicates if the register is readable, and a boolean that indicates if the register is writable, a boolean that indicates the use of an enable signal and a boolean that indicates the use of a reset signal. It stores that information in public variables
    class mmio_reg:
        __name = ""
        __size = 0
        __address = 0
        __reset_value = 0
        __description = ""
        __readable = False
        __writable = False
        __use_enable = False
        __use_reset = False

        # define initializing function which initializes all the variables with the received values
        def __init__(
            self,
            name,
            size,
            address,
            reset_value,
            description,
            readable,
            writable,
            use_enable,
            use_reset,
        ):
            self.__name = name
            self.__size = size
            self.__address = address
            self.__reset_value = reset_value
            self.__description = description
            self.__readable = readable
            self.__writable = writable
            self.__use_enable = use_enable
            self.__use_reset = use_reset

        # define a public method that returns the name of the register
        def get_name(self):
            return self.__name

        # define a public method that returns the size of the register
        def get_size(self):
            return self.__size

        # define a public method that returns the address of the register
        def get_address(self):
            return self.__address

        # define a public method that returns the reset value of the register
        def get_reset_value(self):
            return self.__reset_value

        # define a public method that returns the description of the register
        def get_description(self):
            return self.__description

        # define a public method that returns a boolean that indicates if the register is readable
        def is_readable(self):
            return self.__readable

        # define a public method that returns a boolean that indicates if the register is writable
        def is_writable(self):
            return self.__writable

        # define a public method that returns a boolean that indicates if the register uses an enable signal
        def uses_enable(self):
            return self.__use_enable

        # define a public method that returns a boolean that indicates if the register uses a reset signal
        def uses_reset(self):
            return self.__use_reset


# Check if this script is called directly
if __name__ == "__main__":
    current_directory = os.getcwd()
